# 地图网络图分析系统 - 使用手册

## 目录
1. [系统概述](#系统概述)
2. [安装和编译](#安装和编译)
3. [系统架构](#系统架构)
4. [功能说明](#功能说明)
5. [使用指南](#使用指南)
6. [测试说明](#测试说明)
7. [文件说明](#文件说明)

## 系统概述

地图网络图分析系统是一个基于C++实现的图数据结构应用，用于模拟和管理城市间的交通路线网络。系统支持用户管理、城市信息管理、路线规划、图遍历算法等功能。

### 主要特性
- **双图结构实现**：支持邻接矩阵和邻接表两种图存储方式
- **完整的用户系统**：用户注册、登录、密码管理
- **丰富的图算法**：DFS、BFS遍历，Dijkstra最短路径
- **数据持久化**：自动保存到文件，支持数据导入导出
- **友好的用户界面**：基于文本的菜单系统
- **完善的测试**：包含边界情况和性能测试

## 安装和编译

### 系统要求
- C++11兼容的编译器（推荐GCC 4.8+或Visual Studio 2013+）
- 支持标准C++库的操作系统（Windows/Linux/MacOS）

### 编译步骤

#### 使用Makefile（Linux/MacOS）
```bash
# 编译主程序
make

# 编译测试程序
make test

# 运行程序
./MapNetworkSystem

# 运行测试
./TestProgram

# 清理生成的文件
make clean
```

#### 手动编译
```bash
g++ -std=c++11 -Wall -Wextra -O2 -c City.cpp
g++ -std=c++11 -Wall -Wextra -O2 -c Graph.cpp
g++ -std=c++11 -Wall -Wextra -O2 -c UserManager.cpp
g++ -std=c++11 -Wall -Wextra -O2 -c FileManager.cpp
g++ -std=c++11 -Wall -Wextra -O2 -c MapNetwork.cpp
g++ -std=c++11 -Wall -Wextra -O2 -c MenuSystem.cpp
g++ -std=c++11 -Wall -Wextra -O2 -c main.cpp

g++ -o MapNetworkSystem City.o Graph.o UserManager.o FileManager.o MapNetwork.o MenuSystem.o main.o
```

## 系统架构

### 类结构图
```
┌─────────────┐
│   main.cpp  │
└──────┬──────┘
       │
┌──────▼──────┐
│ MenuSystem  │
└──────┬──────┘
       │
  ┌────┴────┬────────────┐
  ▼         ▼            ▼
┌──────────┐ ┌──────────┐ ┌──────────┐
│MapNetwork│ │UserManage│ │FileManage│
└────┬─────┘ └────┬─────┘ └────┬─────┘
     │            │            │
  ┌──▼──┐      ┌──▼──┐      ┌──▼──┐
│ Graph │    │ User │    │      │
└───────┘    └──────┘    └──────┘
     │
  ┌──┴─────────────┐
  ▼                ▼
┌────────────┐ ┌────────────┐
│AdjacencyMat│ │AdjacencyLst│
│   rix      │ │      ist   │
└────────────┘ └────────────┘
```

### 核心类说明

#### 1. Graph（抽象基类）
- 定义图的基本操作接口
- 实现DFS、BFS、Dijkstra算法
- 作为邻接矩阵和邻接表的基类

#### 2. AdjacencyMatrix（邻接矩阵）
- 使用二维矩阵存储图结构
- 适合稠密图，查询速度快
- 空间复杂度O(V²)

#### 3. AdjacencyList（邻接表）
- 使用链表/向量存储图结构
- 适合稀疏图，空间效率高
- 空间复杂度O(V+E)

#### 4. MapNetwork（地图网络管理）
- 封装图操作，提供高级接口
- 管理城市和路线数据
- 协调各个组件工作

#### 5. UserManager（用户管理）
- 用户注册、登录、认证
- 密码管理
- 用户数据持久化

#### 6. MenuSystem（菜单系统）
- 提供用户交互界面
- 处理用户输入
- 调用相应功能模块

## 功能说明

### 1. 用户管理功能

#### 用户注册
- 支持用户名和密码注册
- 检查用户名唯一性
- 密码加密存储（简化版）

#### 用户登录
- 用户名密码验证
- 登录状态管理
- 支持多用户

#### 密码管理
- 修改密码功能
- 原密码验证
- 自动保存到文件

### 2. 城市管理功能

#### 添加城市
- 输入城市ID和名称
- 检查ID唯一性
- 支持中文城市名

#### 删除城市
- 支持按ID或名称删除
- 自动删除相关路线
- 确认提示

#### 查找城市
- 按ID查找
- 按名称查找
- 显示城市信息

#### 显示所有城市
- 表格形式显示
- 包含ID和名称
- 统计信息

### 3. 路线管理功能

#### 添加路线
- 输入起点、终点、距离
- 检查城市存在性
- 支持双向路线

#### 删除路线
- 支持按城市ID或名称删除
- 确认提示
- 自动更新邻接关系

#### 检查路线
- 验证路线存在性
- 显示路线距离
- 错误提示

### 4. 图算法功能

#### 深度优先搜索（DFS）
- 使用栈实现
- 递归方式
- 输出遍历序列

#### 广度优先搜索（BFS）
- 使用队列实现
- 层次遍历
- 输出遍历序列

#### Dijkstra最短路径
- 使用优先队列优化
- 支持加权图
- 输出完整路径和距离

### 5. 图结构功能

#### 邻接矩阵
- 二维数组存储
- 快速查询
- 适合稠密图

#### 邻接表
- 链表/向量存储
- 空间高效
- 适合稀疏图

#### 动态切换
- 运行时切换
- 自动迁移数据
- 保持功能一致

### 6. 数据持久化功能

#### 文件存储
- 城市数据：cities.txt
- 路线数据：routes.txt
- 用户数据：users.txt

#### 自动保存
- 操作后自动保存
- 防止数据丢失
- 支持手动保存

#### 数据加载
- 启动时自动加载
- 支持手动加载
- 错误处理

## 使用指南

### 启动系统
```bash
./MapNetworkSystem
```

### 主菜单操作
启动后显示主菜单：
```
========================================
   地图网络图分析系统
========================================

1. 用户管理
2. 城市管理
3. 路线管理
4. 导航功能
5. 图操作
6. 数据管理
0. 退出系统

------------------------------------------
当前状态: 未登录
------------------------------------------
```

### 用户管理

#### 1. 用户注册
- 选择主菜单"1. 用户管理"
- 选择"2. 用户注册"
- 输入用户名和密码
- 确认密码
- 完成注册

#### 2. 用户登录
- 选择"1. 用户登录"
- 输入用户名和密码
- 验证成功后登录

#### 3. 修改密码
- 登录后选择"4. 修改密码"
- 输入原密码
- 输入新密码并确认
- 完成修改

### 城市管理

#### 1. 添加城市
- 选择主菜单"2. 城市管理"
- 选择"1. 添加城市"
- 输入城市ID（整数）
- 输入城市名称
- 确认添加

#### 2. 查找城市
- 选择"3. 查找城市"
- 选择查找方式（ID或名称）
- 输入查找条件
- 显示结果

#### 3. 删除城市
- 选择"2. 删除城市"
- 选择删除方式（ID或名称）
- 确认删除
- 自动删除相关路线

### 路线管理

#### 1. 添加路线
- 选择主菜单"3. 路线管理"
- 选择"1. 添加路线"
- 选择输入方式（ID或名称）
- 输入起点、终点、距离
- 确认添加

#### 2. 检查路线
- 选择"3. 检查路线是否存在"
- 输入起点和终点城市
- 显示路线信息和距离

### 导航功能

#### 1. 查找最短路径
- 选择主菜单"4. 导航功能"
- 选择"1. 查找最短路径"
- 输入起点和终点城市
- 显示完整路径和总距离

#### 2. 查找邻近城市
- 选择"2. 查找邻近城市"
- 输入城市名称
- 显示所有邻近城市及距离

### 图操作

#### 1. 图遍历
- 选择主菜单"5. 图操作"
- 选择"1. 深度优先遍历"或"2. 广度优先遍历"
- 输入起始城市
- 显示遍历序列

#### 2. 切换图类型
- 选择"3. 切换图类型"
- 选择邻接矩阵或邻接表
- 系统自动迁移数据

#### 3. 显示网络信息
- 选择"4. 显示网络信息"
- 显示当前图类型、城市数量、路线数量

### 数据管理

#### 1. 保存数据
- 选择主菜单"6. 数据管理"
- 选择"1. 保存数据"
- 数据保存到文件

#### 2. 加载数据
- 选择"2. 加载数据"
- 从文件加载数据
- 更新网络状态

#### 3. 创建默认网络
- 选择"3. 创建默认网络"
- 确认操作（清空现有数据）
- 创建预设的城市和路线

## 测试说明

### 测试程序
运行测试程序：
```bash
./TestProgram
```

### 测试内容

#### 1. 用户管理测试
- 用户注册（包括重复注册）
- 用户登录（正确密码和错误密码）
- 密码修改
- 用户数据持久化

#### 2. 城市管理测试
- 添加城市（包括重复添加）
- 查找城市（按ID和名称）
- 删除城市
- 显示所有城市

#### 3. 路线管理测试
- 添加路线
- 检查路线存在性
- 获取路线距离
- 获取邻近城市
- 删除路线

#### 4. 图算法测试
- DFS遍历
- BFS遍历
- Dijkstra最短路径（多种情况）
- 路径不存在的情况

#### 5. 文件操作测试
- 保存数据到文件
- 从文件加载数据
- 创建默认网络
- 数据完整性验证

#### 6. 边界情况测试
- 空图操作
- 单节点图
- 大规模图性能测试
- 图类型切换

### 测试用例示例

#### 最短路径测试用例
```
北京 -> 上海
路径: 北京 -> 上海
距离: 1200公里

北京 -> 杭州
路径: 北京 -> 上海 -> 杭州
距离: 1400公里

北京 -> 成都
路径: 北京 -> 南京 -> 武汉 -> 成都
距离: 2600公里
```

#### 图遍历测试用例
```
DFS遍历（从北京开始）:
北京 -> 上海 -> 杭州 -> 广州 -> 深圳 -> 武汉 -> 成都 -> 南京

BFS遍历（从北京开始）:
北京 -> 上海 -> 南京 -> 杭州 -> 武汉 -> 广州 -> 深圳 -> 成都
```

## 文件说明

### 源文件列表

#### 头文件 (.h)
- `City.h` - 城市类声明
- `Graph.h` - 图基类及派生类声明
- `UserManager.h` - 用户管理类声明
- `FileManager.h` - 文件管理类声明
- `MapNetwork.h` - 地图网络管理类声明
- `MenuSystem.h` - 菜单系统类声明

#### 实现文件 (.cpp)
- `City.cpp` - 城市类实现
- `Graph.cpp` - 图类实现（包括DFS、BFS、Dijkstra算法）
- `UserManager.cpp` - 用户管理实现
- `FileManager.cpp` - 文件管理实现
- `MapNetwork.cpp` - 地图网络管理实现
- `MenuSystem.cpp` - 菜单系统实现
- `main.cpp` - 主程序入口
- `TestProgram.cpp` - 测试程序

#### 数据文件
- `users.txt` - 用户数据存储
- `cities.txt` - 城市数据存储
- `routes.txt` - 路线数据存储

#### 其他文件
- `Makefile` - 编译脚本
- `README.md` - 项目说明
- `使用手册.md` - 本手册

### 编译后文件
- `MapNetworkSystem` - 主程序可执行文件
- `TestProgram` - 测试程序可执行文件
- `*.o` - 目标文件

## 技术特点

### 1. 面向对象设计
- 使用类和对象封装数据和行为
- 继承和多态实现灵活的图结构
- 封装实现细节，提供清晰接口

### 2. 模板方法模式
- Graph基类定义算法框架
- 派生类实现具体操作
- 运行时多态选择实现

### 3. 异常安全
- 输入验证和错误处理
- 资源管理（RAII）
- 异常传播和捕获

### 4. 数据持久化
- 文件I/O操作
- 数据序列化
- 错误恢复机制

### 5. 算法优化
- 优先队列优化Dijkstra
- 哈希表加速查找
- 最小化内存分配

## 扩展建议

### 1. 可视化功能
- 使用图形库（如Qt、SDL）
- 绘制网络拓扑图
- 高亮显示路径

### 2. 性能优化
- 多线程处理
- 缓存机制
- 数据库支持

### 3. 功能扩展
- 实时交通信息
- 多种路径算法（A*、Floyd）
- 路线权重动态调整

### 4. 网络功能
- 客户端/服务器架构
- 多用户并发访问
- 数据同步机制

## 常见问题

### Q1: 编译失败怎么办？
A: 检查编译器版本是否支持C++11，确保所有文件在同一目录。

### Q2: 数据文件丢失怎么办？
A: 系统会自动创建默认数据，或使用"创建默认网络"功能。

### Q3: 如何切换图类型？
A: 在主菜单选择"5. 图操作" -> "3. 切换图类型"。

### Q4: 最短路径算法效率如何？
A: 使用优先队列优化，时间复杂度O(E + V log V)。

### Q5: 支持多大的网络？
A: 理论上支持数千个节点，实际受内存限制。

## 联系信息

如有问题或建议，请随时反馈。

---

**版本**: 1.0  
**日期**: 2025年  
**作者**: 地图网络图分析系统开发团队